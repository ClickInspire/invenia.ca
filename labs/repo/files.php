<?php    /* These are our valid username and passwords */    include 'credential.php';    if (isset($_COOKIE['username']) && isset($_COOKIE['password'])) {                if (($_COOKIE['username'] != $user) || ($_COOKIE['password'] != md5($pass))) {                                    header('Location: login.php');                    }    } else {        header('Location: login.php');    }        ?><html><title>Invenia Labs Repo</title><img src="img/InveniaLabs.jpg"><br><br><a href="conf.php">Go back</a><br><br><?php    /* These are our valid username and passwords */    include 'credential.php';    if (isset($_COOKIE['username']) && isset($_COOKIE['password'])) {                if (($_COOKIE['username'] != $user) || ($_COOKIE['password'] != md5($pass))) {                                    header('Location: login.php');                    }    } else {        header('Location: login.php');    }        ?><html><?php        if ($_SERVER["REQUEST_METHOD"] == "POST")  {                                                                if (empty($_POST["linkt"])) {                                                // Configuration - Your Options                        $allowed_filetypes = array('.pdf','.doc','.docx','.txt',); // These will be the types of file that will pass the validation.                        $max_filesize = 10000000; // Maximum filesize in BYTES (currently ca 2MB).                        $upload_path = wp_upload_dir(); // The place the files will be uploaded to (currently a 'files' directory).                        echo $upload_path['basedir'];                                                $filename = $_FILES['userfile']['name']; // Get the name of the file (including file extension).                        $ext = substr($filename, strpos($filename,'.'), strlen($filename)-1); // Get the extension from the filename.                                                // Check if the filetype is allowed, if not DIE and inform the user.                        if(!in_array($ext,$allowed_filetypes))                                die('The file you attempted to upload is not allowed.<br>');                                                // Now check the filesize, if it is too large then DIE and inform the user.                        if(filesize($_FILES['userfile']['tmp_name']) > $max_filesize)                                die('The file you attempted to upload is too large.<br><br>');                                                // Check if we can upload to the specified path, if not DIE and inform the user.                        if(!is_writable($upload_path['basedir']))                                die('You cannot upload to the specified directory, please CHMOD it to 777.<br><br>');                                                // We'll start handling the upload in the next step                        if(move_uploaded_file($_FILES['userfile']['tmp_name'],$upload_path['basedir'] . $filename))                                //    {                                echo 'Your file upload was successful, view the file <a href="' . $upload_path['baseurl'] . $filename . '" title="Your File">here</a><br><br>'; // It worked.                        //    } else {                        //      echo "There was an error during file upload. Please try again or contact the administrator<br><br>";                        //    }                                            } else {                                                $filename=$_POST["linkt"];                        $upload_path='';                                            }                                                                $file=simplexml_load_file('file.xml');                $myFile2 = "file.xml";                $fh2 = fopen($myFile2, 'w') or die("can't open file");                                fprintf($fh2,"<file>\r\t");                foreach ($file->files as $vfile) {                        fprintf($fh2,"   <files>\r\n");                        fprintf($fh2,"      <index>%d</index>\r\n",$vfile->index);                        fprintf($fh2,"      <name>%s</name>\r\n",$vfile->name);                        fprintf($fh2,"   </files>\r\n");                    }                                fprintf($fh2,"   <files>\r\n");                fprintf($fh2,"      <index>%d</index>\r\n",$vfile->index+1);                fprintf($fh2,"      <name>%s</name>\r\n",$upload_path['baseurl'] . $filename);                fprintf($fh2,"   </files>\r\n");                                fprintf($fh2,"</file>\r\n");                fclose($fh2);                                //     }      else {                //         echo 'There was an error during the file upload.  Please try again.<br><br>'; // It failed :(.                                //    }                            }                         echo "File list:<br><br>";                $file=simplexml_load_file('file.xml');                foreach ($file->files as $vfile) {                                printf("%d) \"%s\"<br>",$vfile->index,$vfile->name);                            }                        ?><br><br><br>Add new file:<form  method="post" enctype="multipart/form-data"><p><label for="file">Select a file:</label> <input type="file" name="userfile" id="file"> <br /><font color="black">Leave this field empty if uploading file; Add "Library/" before the name of the file if the file is uploaded manually, or insert "http://" if adding a link.<br><br>Manual link/file:</font> <input type="text" name="linkt" size="100"><br><input type="submit" action="<?php echo htmlspecialchars($_SERVER["PHP_SELF"]);?>" value="Upload File"><p></form></html>